<div class="pending-wrapper">   <!-- reuse wrapper -->

  <div class="header-row d-flex justify-space-between align-center">
    <h2 class="page-title">ðŸ›  Repairs List</h2>

    <button class="btn-add" routerLink="/repair-form">
      âž• Add Repair
    </button>
  </div>

  <!-- Filter -->
  <div class="filter-row">
    <label>Status:</label>
    <select [(ngModel)]="filterStatus" (change)="applyFilter()">
      <option value="">All</option>
      <option value="pending">Pending</option>
      <option value="in-progress">In Progress</option>
      <option value="completed">Completed</option>
    </select>
  </div>

  <!-- List -->
  <div *ngIf="filteredRepairs.length > 0">

    <div class="pending-card" *ngFor="let r of filteredRepairs">

      <!-- ROW 1 -->
      <div class="row1">
        <div>
          <b>{{ r.customerName || 'Unknown' }}</b>
          <p>{{ r.customerPhone }}</p>
        </div>

        <div class="amount d-grid" *ngIf="r.pendingAmount > 0">
          <span class="pending">â‚¹{{ r.pendingAmount }}</span>
        </div>
      </div>

      <!-- ROW 1.5 : Type + Status -->
      <div class="row1">
        <small class="type-badge Repair">Repair</small>

        <small
          class="status-pill"
          [ngClass]="r.status"
        >
          {{ r.status | titlecase }}
        </small>
      </div>

      <!-- ROW 2 -->
      <div class="row2">
        <span><b>Total:</b> â‚¹{{ r.estimatedAmount }}</span>
        <span><b>Paid:</b> â‚¹{{ r.paidAmount }}</span>
      </div>

      <!-- ROW 3 -->
      <div class="row3">
        <span><b>Device:</b> {{ r.deviceName }}</span>
        <span><b>Date:</b> {{ r.inDate?.toDate() | date:'mediumDate' }}</span>        
      </div>

      <div class="row3">
        <span><b>Issue:</b> {{r.issue }}</span>
      </div>

      <!-- ACTIONS -->
      <button
        *ngIf="r.pendingAmount > 0"
        class="button-complete"
        (click)="addPayment(r)"
      >
        Add Payment
      </button>

      <button
        *ngIf="r.status !== 'completed'"
        class="button-complete"
        (click)="completeWithPayment(r)"
      >
        Mark as Completed
      </button>

    </div>

  </div>

  <!-- Empty -->
  <div *ngIf="filteredRepairs.length === 0" class="info-box">
    No repair jobs found.
  </div>

</div>
