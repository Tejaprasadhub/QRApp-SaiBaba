<h2>Products</h2>
<a routerLink="/products/add">‚ûï Add product</a>

<table border="1" cellpadding="6" style="margin-top:10px; width:100%; border-collapse: collapse;">
  <tr style="background-color:#f3f3f3;">
    <th>Name</th>
    <th>Category</th>
    <th>Brand</th>
    <th>Price</th>
    <th>Stock</th>
    <th style="width:180px; text-align:center;">Actions</th>
  </tr>

  <tr *ngFor="let p of products">
    <ng-container *ngIf="editingProduct?.id === p.id; else viewMode">
      <td><input [(ngModel)]="editingProduct.name" /></td>

      <td>
        <select [(ngModel)]="editingProduct.categoryId">
          <option value="">Select</option>
          <option *ngFor="let c of categories" [value]="c.id">{{ c.name }}</option>
        </select>
      </td>

      <td>
        <select [(ngModel)]="editingProduct.subcategoryId">
          <option value="">Select</option>
          <option *ngFor="let s of filteredSubcategories()" [value]="s.id">
            {{ s.name }}
          </option>
        </select>
      </td>

      <td><input type="number" [(ngModel)]="editingProduct.price" /></td>
      <td><input type="number" [(ngModel)]="editingProduct.stock" /></td>

      <td style="text-align:center;">
        <button (click)="saveEdit()" [disabled]="loading">üíæ Save</button>
        <button (click)="cancelEdit()">‚úñ Cancel</button>
      </td>
    </ng-container>

    <ng-template #viewMode>
      <td>{{ p.name }}</td>
      <td>{{ p.categoryName }}</td>
      <td>{{ p.subcategoryName }}</td>
      <td>‚Çπ{{ p.price }}</td>
      <td>{{ p.stock }}</td>
      <td style="text-align:center;">
        <button (click)="startEdit(p)">‚úèÔ∏è Edit</button>
        <button (click)="delete(p.id)" style="color:red;">üóë Delete</button>
      </td>
    </ng-template>
  </tr>

  <tr *ngIf="!products.length">
    <td colspan="6" style="text-align:center; color:gray;">No products found.</td>
  </tr>
</table>
